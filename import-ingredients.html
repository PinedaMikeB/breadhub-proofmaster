<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BreadHub ProofMaster - Import Ingredients</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f5f5; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { color: #D4894A; margin-bottom: 10px; }
        .subtitle { color: #666; margin-bottom: 30px; }
        .section { background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        .section h3 { margin-bottom: 15px; color: #333; }
        .stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
        .stat-card { background: white; padding: 15px; border-radius: 8px; text-align: center; border: 1px solid #e0e0e0; }
        .stat-card .number { font-size: 2rem; font-weight: bold; color: #D4894A; }
        .stat-card .label { color: #666; font-size: 0.9rem; }
        .btn { padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; font-weight: 500; margin-right: 10px; }
        .btn-primary { background: #D4894A; color: white; }
        .btn-primary:hover { background: #c17a3a; }
        .btn-primary:disabled { background: #ccc; cursor: not-allowed; }
        .log { background: #1a1a2e; color: #0f0; padding: 15px; border-radius: 8px; font-family: monospace; font-size: 0.85rem; max-height: 400px; overflow-y: auto; white-space: pre-wrap; }
        .progress { height: 20px; background: #e0e0e0; border-radius: 10px; overflow: hidden; margin: 15px 0; display: none; }
        .progress-bar { height: 100%; background: linear-gradient(90deg, #D4894A, #e9a066); transition: width 0.3s; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ü•ñ BreadHub ProofMaster</h1>
        <p class="subtitle">Bulk Import Ingredients with Supplier Prices</p>
        
        <div class="section">
            <h3>üìä Import Summary</h3>
            <div class="stats">
                <div class="stat-card"><div class="number">7</div><div class="label">Suppliers</div></div>
                <div class="stat-card"><div class="number">145</div><div class="label">Ingredients</div></div>
                <div class="stat-card"><div class="number">158</div><div class="label">Price Entries</div></div>
            </div>
        </div>

        <div class="section">
            <h3>üîê Authentication</h3>
            <p id="authStatus">Checking... Please sign in to your BreadHub app first.</p>
        </div>

        <div style="margin-bottom: 20px;">
            <button class="btn btn-primary" id="startImport" disabled onclick="startImport()">üöÄ Start Import</button>
        </div>

        <div class="progress" id="progressContainer">
            <div class="progress-bar" id="progressBar" style="width: 0%"></div>
        </div>

        <div class="section">
            <h3>üìù Import Log</h3>
            <div class="log" id="log">Waiting to start...

Make sure you are signed into BreadHub ProofMaster first!</div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyB8YBUQP-q5XvoKNQ5B1THOeeMDkxFnh1k",
            authDomain: "breadhub-proofmaster.firebaseapp.com",
            projectId: "breadhub-proofmaster",
            storageBucket: "breadhub-proofmaster.firebasestorage.app",
            messagingSenderId: "1044051191922",
            appId: "1:1044051191922:web:2c35f5f4f9e0a0c4dffbd0"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        
        // Import data from Excel analysis - 7 suppliers, 145 ingredients, 158 price entries
        const importData = {
            "suppliers": [
                {"companyName": "Highlander Grains Trading", "location": "Antipolo", "deliveryFee": 0, "freeDeliveryMin": 0},
                {"companyName": "All About Baking SM Taytay", "location": "Taytay", "deliveryFee": 0, "freeDeliveryMin": 0},
                {"companyName": "SM Hypermarket Antipolo", "location": "Antipolo", "deliveryFee": 0, "freeDeliveryMin": 0},
                {"companyName": "Baking And Home Depot", "location": "Other", "deliveryFee": 0, "freeDeliveryMin": 0},
                {"companyName": "Palengke Transfiguration", "location": "Antipolo", "deliveryFee": 0, "freeDeliveryMin": 0},
                {"companyName": "Lazada", "location": "Other", "deliveryFee": 0, "freeDeliveryMin": 0},
                {"companyName": "Easy", "location": "Taytay", "deliveryFee": 0, "freeDeliveryMin": 0}
            ],
            "ingredients": [
                {"name": "Margarine", "category": "fat", "prices": [{"supplierName": "Highlander Grains Trading", "purchasePrice": 110, "packageSize": 1000, "costPerGram": 0.11}]},
                {"name": "Bread Crumbs", "category": "topping", "prices": [{"supplierName": "Highlander Grains Trading", "purchasePrice": 45, "packageSize": 1000, "costPerGram": 0.045}]},
                {"name": "Baking Powder", "category": "leavening", "prices": [{"supplierName": "Highlander Grains Trading", "purchasePrice": 70, "packageSize": 1000, "costPerGram": 0.07}]},
                {"name": "Lard", "category": "fat", "prices": [{"supplierName": "Highlander Grains Trading", "purchasePrice": 104, "packageSize": 1000, "costPerGram": 0.104}]},
                {"name": "Washed Sugar", "category": "sugar", "prices": [{"supplierName": "Highlander Grains Trading", "purchasePrice": 66, "packageSize": 1000, "costPerGram": 0.066}]},
                {"name": "Cinnamon Powder", "category": "flavoring", "prices": [{"supplierName": "Highlander Grains Trading", "purchasePrice": 200, "packageSize": 1000, "costPerGram": 0.2}]},
                {"name": "3rd Class Powder", "category": "flour", "prices": [{"supplierName": "Highlander Grains Trading", "purchasePrice": 38, "packageSize": 1000, "costPerGram": 0.038}]},
                {"name": "1st Class Flour Globe", "category": "flour", "prices": [{"supplierName": "Highlander Grains Trading", "purchasePrice": 905, "packageSize": 25000, "costPerGram": 0.0362}]},
                {"name": "Milk Boy", "category": "dairy", "prices": [{"supplierName": "Highlander Grains Trading", "purchasePrice": 255, "packageSize": 1000, "costPerGram": 0.255}]},
                {"name": "Cake Flour", "category": "flour", "prices": [{"supplierName": "Highlander Grains Trading", "purchasePrice": 50, "packageSize": 1000, "costPerGram": 0.05}]},
                {"name": "Vanilla", "category": "flavoring", "prices": [{"supplierName": "Highlander Grains Trading", "purchasePrice": 51, "packageSize": 350, "costPerGram": 0.145714}]},
                {"name": "Yeast", "category": "leavening", "prices": [{"supplierName": "Highlander Grains Trading", "purchasePrice": 125, "packageSize": 500, "costPerGram": 0.25}]},
                {"name": "Cornstarch", "category": "other", "prices": [{"supplierName": "Highlander Grains Trading", "purchasePrice": 42, "packageSize": 1000, "costPerGram": 0.042}]},
                {"name": "Oil", "category": "fat", "prices": [{"supplierName": "Highlander Grains Trading", "purchasePrice": 117, "packageSize": 1500, "costPerGram": 0.078}]},
                {"name": "Salt", "category": "flavoring", "prices": [{"supplierName": "Highlander Grains Trading", "purchasePrice": 20, "packageSize": 1000, "costPerGram": 0.02}]},
                {"name": "Bread Improver", "category": "other", "prices": [{"supplierName": "Highlander Grains Trading", "purchasePrice": 130, "packageSize": 1000, "costPerGram": 0.13}]},
                {"name": "White Sugar", "category": "sugar", "prices": [{"supplierName": "Highlander Grains Trading", "purchasePrice": 76, "packageSize": 1000, "costPerGram": 0.076}]},
                {"name": "Choco Powder", "category": "flavoring", "prices": [{"supplierName": "Highlander Grains Trading", "purchasePrice": 140, "packageSize": 1000, "costPerGram": 0.14}]},
                {"name": "Chicken Floss Seaweed", "category": "topping", "prices": [{"supplierName": "All About Baking SM Taytay", "purchasePrice": 1000, "packageSize": 660, "costPerGram": 1.515152}]},
                {"name": "Spicy Pork Floss", "category": "topping", "prices": [{"supplierName": "All About Baking SM Taytay", "purchasePrice": 1000, "packageSize": 693, "costPerGram": 1.443001}]},
                {"name": "Semisweet Choco Sweet", "category": "flavoring", "prices": [{"supplierName": "All About Baking SM Taytay", "purchasePrice": 1000, "packageSize": 290, "costPerGram": 3.448276}]},
                {"name": "Crispy Chicken Floss", "category": "topping", "prices": [{"supplierName": "All About Baking SM Taytay", "purchasePrice": 1000, "packageSize": 595, "costPerGram": 1.680672}]},
                {"name": "Queensland Butter", "category": "topping", "prices": [{"supplierName": "All About Baking SM Taytay", "purchasePrice": 1000, "packageSize": 150, "costPerGram": 6.666667}, {"supplierName": "Baking And Home Depot", "purchasePrice": 225, "packageSize": 126, "costPerGram": 1.785714}]},
                {"name": "Beryls White Chocolate Bar", "category": "flavoring", "prices": [{"supplierName": "All About Baking SM Taytay", "purchasePrice": 1000, "packageSize": 360, "costPerGram": 2.777778}]},
                {"name": "Powder Sugar", "category": "topping", "prices": [{"supplierName": "All About Baking SM Taytay", "purchasePrice": 1000, "packageSize": 142, "costPerGram": 7.042254}]},
                {"name": "Jersey All purpose Cream", "category": "topping", "prices": [{"supplierName": "All About Baking SM Taytay", "purchasePrice": 1000, "packageSize": 264, "costPerGram": 3.787879}]},
                {"name": "Vizyon Pistachio", "category": "flavoring", "prices": [{"supplierName": "All About Baking SM Taytay", "purchasePrice": 750, "packageSize": 2480, "costPerGram": 0.302419}]},
                {"name": "Nescafe Instant Coffee", "category": "topping", "prices": [{"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 180, "packageSize": 104, "costPerGram": 1.722488}]},
                {"name": "Great Taste", "category": "topping", "prices": [{"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 50, "packageSize": 51, "costPerGram": 0.970874}]},
                {"name": "Blend 45", "category": "topping", "prices": [{"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 25, "packageSize": 22, "costPerGram": 1.111111}]},
                {"name": "Century Tuna", "category": "filling", "prices": [{"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 420, "packageSize": 102, "costPerGram": 4.097561}, {"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 155, "packageSize": 34, "costPerGram": 4.532164}]},
                {"name": "Chevital Quickmelt", "category": "topping", "prices": [{"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 1000, "packageSize": 410, "costPerGram": 2.439024}]},
                {"name": "Lotte Spam", "category": "filling", "prices": [{"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 470, "packageSize": 239, "costPerGram": 1.962422}, {"supplierName": "Baking And Home Depot", "purchasePrice": 340, "packageSize": 98, "costPerGram": 3.469388}]},
                {"name": "Ladies Choice Mayo", "category": "topping", "prices": [{"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 470, "packageSize": 196, "costPerGram": 2.391858}, {"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 470, "packageSize": 198, "costPerGram": 2.367758}, {"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 3500, "packageSize": 1168, "costPerGram": 2.995293}]},
                {"name": "Kewpie", "category": "topping", "prices": [{"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 500, "packageSize": 206, "costPerGram": 2.421308}]},
                {"name": "Eden Regular", "category": "topping", "prices": [{"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 430, "packageSize": 145, "costPerGram": 2.965517}]},
                {"name": "Vida Bacon", "category": "filling", "prices": [{"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 250, "packageSize": 152, "costPerGram": 1.644737}, {"supplierName": "Palengke Transfiguration", "purchasePrice": 250, "packageSize": 100, "costPerGram": 2.5}]},
                {"name": "Vida Sweet Ham", "category": "filling", "prices": [{"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 250, "packageSize": 73, "costPerGram": 3.401361}, {"supplierName": "Palengke Transfiguration", "purchasePrice": 250, "packageSize": 55, "costPerGram": 4.545455}]},
                {"name": "CDO Idol Cheesedog", "category": "filling", "prices": [{"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 250, "packageSize": 64, "costPerGram": 3.90625}]},
                {"name": "CDO Chicken Frank", "category": "filling", "prices": [{"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 250, "packageSize": 64, "costPerGram": 3.875969}]},
                {"name": "Egg", "category": "egg", "prices": [{"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 30, "packageSize": 275, "costPerGram": 0.109091}]},
                {"name": "CDO Cheesedog", "category": "filling", "prices": [{"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 1000, "packageSize": 185, "costPerGram": 5.390836}]},
                {"name": "PF TJ Hotdog", "category": "filling", "prices": [{"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 1000, "packageSize": 200, "costPerGram": 5.0}]},
                {"name": "Alaska Evaporated", "category": "filling", "prices": [{"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 1000, "packageSize": 94, "costPerGram": 10.582011}]},
                {"name": "Alaska Condensed", "category": "filling", "prices": [{"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 1200, "packageSize": 165, "costPerGram": 7.237636}]},
                {"name": "Angel Creamer", "category": "filling", "prices": [{"supplierName": "SM Hypermarket Antipolo", "purchasePrice": 250, "packageSize": 84, "costPerGram": 2.97619}]},
                {"name": "Prochiz Cheddar", "category": "filling", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2000, "packageSize": 568, "costPerGram": 3.521127}]},
                {"name": "Blueberry Donut Filling", "category": "filling", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2000, "packageSize": 275, "costPerGram": 7.272727}]},
                {"name": "Strawberry Donut Filling", "category": "filling", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2000, "packageSize": 295, "costPerGram": 6.779661}]},
                {"name": "Dulce De Leche Donut Filling", "category": "filling", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2000, "packageSize": 270, "costPerGram": 7.407407}]},
                {"name": "Bavarian Donut Filling", "category": "filling", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2000, "packageSize": 270, "costPerGram": 7.407407}]},
                {"name": "Chocolate Donut Filling", "category": "filling", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2000, "packageSize": 390, "costPerGram": 5.128205}]},
                {"name": "Kewpie Mayo", "category": "filling", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 295, "costPerGram": 3.389831}]},
                {"name": "Oleo Butter", "category": "filling", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 225, "packageSize": 62, "costPerGram": 3.629032}]},
                {"name": "Coffee Emulco", "category": "filling", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 100, "packageSize": 158, "costPerGram": 0.632911}]},
                {"name": "Chocolate Emulco", "category": "filling", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 100, "packageSize": 158, "costPerGram": 0.632911}]},
                {"name": "Pastry Pouch", "category": "filling", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 100, "packageSize": 78, "costPerGram": 1.282051}]},
                {"name": "Xanthan Gum", "category": "filling", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 50, "packageSize": 120, "costPerGram": 0.416667}]},
                {"name": "Eazy Caramel Drizzle", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1400, "packageSize": 345, "costPerGram": 4.057971}]},
                {"name": "Easzy Salted Caramel Syrup", "category": "filling", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2500, "packageSize": 345, "costPerGram": 7.246377}]},
                {"name": "Eazy Vanilla Syrup", "category": "filling", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2500, "packageSize": 345, "costPerGram": 7.246377}]},
                {"name": "Bakersfield Whipit", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 260, "costPerGram": 3.846154}]},
                {"name": "Beryls Semisweet Choco Bar", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 335, "costPerGram": 2.985075}]},
                {"name": "Eazy Hazelnut Syrup", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2500, "packageSize": 345, "costPerGram": 7.246377}]},
                {"name": "Susu Master Barista Milk", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 82, "costPerGram": 12.195122}]},
                {"name": "Conaprole Full Cream Milk", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 85, "costPerGram": 11.764706}]},
                {"name": "Blueberry Jam", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 3000, "packageSize": 340, "costPerGram": 8.823529}]},
                {"name": "Brown Sugar 100pcs Pack", "category": "sugar", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 100, "packageSize": 110, "costPerGram": 0.909091}]},
                {"name": "White Sugar 100pcs Pack", "category": "sugar", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 100, "packageSize": 110, "costPerGram": 0.909091}]},
                {"name": "Peotraco Corn Syrup", "category": "sugar", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 110, "costPerGram": 9.090909}]},
                {"name": "Maraschino Cherry Clara Ole", "category": "other", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 280, "packageSize": 149, "costPerGram": 1.879195}]},
                {"name": "Peotraco Confectioners Sugar", "category": "sugar", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2272, "packageSize": 210, "costPerGram": 10.819048}]},
                {"name": "Burgundy Food Color", "category": "other", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 28, "packageSize": 75, "costPerGram": 0.373333}]},
                {"name": "Peach Food Color", "category": "other", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 28, "packageSize": 75, "costPerGram": 0.373333}]},
                {"name": "Fuschia Pink Food Color", "category": "other", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 28, "packageSize": 75, "costPerGram": 0.373333}]},
                {"name": "Boba", "category": "other", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 60, "costPerGram": 16.666667}]},
                {"name": "Cream Cheese Walling", "category": "other", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 500, "packageSize": 280, "costPerGram": 1.785714}]},
                {"name": "Casa Jasmine Greentea", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 335, "costPerGram": 2.985075}]},
                {"name": "Easy Creamer Pro", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 225, "costPerGram": 4.444444}]},
                {"name": "Mleko UHT Milk", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 76, "costPerGram": 13.157895}]},
                {"name": "Vana Blanca", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 195, "costPerGram": 5.128205}]},
                {"name": "Easy Brown Sugar Syrup", "category": "sugar", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2500, "packageSize": 345, "costPerGram": 7.246377}]},
                {"name": "Easy Sugarfree Sweetener", "category": "sugar", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2000, "packageSize": 145, "costPerGram": 13.793103}]},
                {"name": "Wintermelon Syrup", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2300, "packageSize": 330, "costPerGram": 6.969697}]},
                {"name": "Mango Puree", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 195, "costPerGram": 5.128205}]},
                {"name": "Ersao Tapioca", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 85, "costPerGram": 11.764706}]},
                {"name": "Millin Blueberry Syrup", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2500, "packageSize": 240, "costPerGram": 10.416667}]},
                {"name": "Cremidor", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 380, "costPerGram": 2.631579}, {"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 398, "costPerGram": 2.512563}]},
                {"name": "Mung Bean Paste", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 178, "costPerGram": 5.617978}]},
                {"name": "Graham Crackers", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 200, "packageSize": 46, "costPerGram": 4.347826}]},
                {"name": "Beryls Choco Chip", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 350, "costPerGram": 2.857143}]},
                {"name": "Lotte Luncheon Meat", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 340, "packageSize": 98, "costPerGram": 3.469388}, {"supplierName": "Baking And Home Depot", "purchasePrice": 340, "packageSize": 93, "costPerGram": 3.655914}]},
                {"name": "Sesame Seed", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 250, "packageSize": 75, "costPerGram": 3.333333}]},
                {"name": "Almond Flour", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 650, "costPerGram": 1.538462}]},
                {"name": "Ube Paste", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 178, "costPerGram": 5.617978}]},
                {"name": "Tapioca", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 88, "costPerGram": 11.363636}]},
                {"name": "Jolly Cow Fresh Milk", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 92, "costPerGram": 10.869565}]},
                {"name": "Oat Milk", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 155, "costPerGram": 6.451613}]},
                {"name": "Biscoff Smooth", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 400, "packageSize": 379, "costPerGram": 1.055409}]},
                {"name": "Biscoff Biscuit", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 124, "packageSize": 144, "costPerGram": 0.861111}, {"supplierName": "Baking And Home Depot", "purchasePrice": 250, "packageSize": 165, "costPerGram": 1.515152}]},
                {"name": "Biscoff Crumbs", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 750, "packageSize": 440, "costPerGram": 1.704545}, {"supplierName": "Baking And Home Depot", "purchasePrice": 750, "packageSize": 420, "costPerGram": 1.785714}]},
                {"name": "Oreo Crushed", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 454, "packageSize": 180, "costPerGram": 2.522222}]},
                {"name": "Pork Floss", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 400, "costPerGram": 2.5}]},
                {"name": "Diced Pistachio", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 250, "packageSize": 590, "costPerGram": 0.423729}]},
                {"name": "Pistachio Cream", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 750, "packageSize": 1890, "costPerGram": 0.396825}]},
                {"name": "Yarra Barista Milk", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 82, "costPerGram": 12.195122}]},
                {"name": "Lotus Biscoff Spread", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 3000, "packageSize": 2450, "costPerGram": 1.22449}]},
                {"name": "Oleo Butter 2.5kg", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2500, "packageSize": 640, "costPerGram": 3.90625}]},
                {"name": "White Color Food", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 30, "packageSize": 75, "costPerGram": 0.4}]},
                {"name": "Frappe Base", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 230, "costPerGram": 4.347826}, {"supplierName": "Easy", "purchasePrice": 1000, "packageSize": 235, "costPerGram": 4.255319}]},
                {"name": "Easy Whip", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 210, "costPerGram": 4.761905}]},
                {"name": "Almond Sliced", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 690, "costPerGram": 1.449275}]},
                {"name": "Magnolia Mayo", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 3500, "packageSize": 668, "costPerGram": 5.239521}]},
                {"name": "Crushed Graham", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 200, "packageSize": 50, "costPerGram": 4.0}]},
                {"name": "Yogurt Syrup", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2200, "packageSize": 300, "costPerGram": 7.333333}]},
                {"name": "Crushed Oreo", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 454, "packageSize": 180, "costPerGram": 2.522222}]},
                {"name": "Magnola Cheese", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2000, "packageSize": 485, "costPerGram": 4.123711}]},
                {"name": "Nuttella", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 900, "packageSize": 605, "costPerGram": 1.487603}]},
                {"name": "Magnolia All Purpose Cream", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 130, "costPerGram": 7.692308}]},
                {"name": "Holiday White Sugar", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 50, "packageSize": 55, "costPerGram": 0.909091}]},
                {"name": "Beryls Gourmet White Chocolate Compound", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 370, "costPerGram": 2.702703}]},
                {"name": "Beryls Gourmet Semisweet Chocolate Compound", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 335, "costPerGram": 2.985075}]},
                {"name": "Milin Blueberry Syrup", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2500, "packageSize": 240, "costPerGram": 10.416667}]},
                {"name": "Milin Green Apple", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2000, "packageSize": 240, "costPerGram": 8.333333}]},
                {"name": "Buenas Macapuno String", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 907, "packageSize": 340, "costPerGram": 2.667647}]},
                {"name": "Easy Caramel Flavoured Syrup", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2500, "packageSize": 345, "costPerGram": 7.246377}]},
                {"name": "Easy Vanilla Syrup", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2500, "packageSize": 345, "costPerGram": 7.246377}]},
                {"name": "Easy Caramel Drizzle", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1400, "packageSize": 345, "costPerGram": 4.057971}]},
                {"name": "Easy Sweetener", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2000, "packageSize": 145, "costPerGram": 13.793103}]},
                {"name": "Quaker Quick Cook Oatmeal", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 260, "costPerGram": 3.846154}]},
                {"name": "Peotraco Confectioner", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2000, "packageSize": 185, "costPerGram": 10.810811}]},
                {"name": "Milin Honey Peach Pieces", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 240, "costPerGram": 4.166667}]},
                {"name": "Anchor Cream Cheese", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 1000, "packageSize": 560, "costPerGram": 1.785714}]},
                {"name": "Oleo Butter Unsalted", "category": "topping", "prices": [{"supplierName": "Baking And Home Depot", "purchasePrice": 2500, "packageSize": 640, "costPerGram": 3.90625}]},
                {"name": "CDO Idol Chesedog", "category": "filling", "prices": [{"supplierName": "Palengke Transfiguration", "purchasePrice": 250, "packageSize": 55, "costPerGram": 4.545455}]},
                {"name": "Magic Whizk Whipping Cream", "category": "other", "prices": [{"supplierName": "Lazada", "purchasePrice": 1000, "packageSize": 405, "costPerGram": 2.469136}]},
                {"name": "Fermipan 2 In 1", "category": "other", "prices": [{"supplierName": "Lazada", "purchasePrice": 500, "packageSize": 190, "costPerGram": 2.631579}]},
                {"name": "Chiffon Aide Hicaps", "category": "other", "prices": [{"supplierName": "Lazada", "purchasePrice": 1000, "packageSize": 233, "costPerGram": 4.291845}]},
                {"name": "Hicaps Vanilla Emulco", "category": "other", "prices": [{"supplierName": "Lazada", "purchasePrice": 1000, "packageSize": 1250, "costPerGram": 0.8}]},
                {"name": "OK Cheese", "category": "other", "prices": [{"supplierName": "Lazada", "purchasePrice": 2000, "packageSize": 605, "costPerGram": 3.305785}]},
                {"name": "Ceremonial Grade Matcha", "category": "other", "prices": [{"supplierName": "Lazada", "purchasePrice": 100, "packageSize": 456, "costPerGram": 0.219298}]},
                {"name": "Cooking Grade Matcha", "category": "other", "prices": [{"supplierName": "Lazada", "purchasePrice": 100, "packageSize": 329, "costPerGram": 0.303951}]},
                {"name": "Sugarfree", "category": "other", "prices": [{"supplierName": "Easy", "purchasePrice": 20000, "packageSize": 1050, "costPerGram": 19.047619}]},
                {"name": "Dark Choco Powder", "category": "other", "prices": [{"supplierName": "Easy", "purchasePrice": 1000, "packageSize": 365, "costPerGram": 2.739726}]},
                {"name": "Choco Sauce", "category": "other", "prices": [{"supplierName": "Easy", "purchasePrice": 2000, "packageSize": 450, "costPerGram": 4.444444}]}
            ]
        };

        let existingSuppliers = {};
        let existingIngredients = {};

        // Check auth state
        auth.onAuthStateChanged(async (user) => {
            if (user) {
                document.getElementById('authStatus').innerHTML = '<span style="color:#51cf66">‚úì Signed in as ' + user.email + '</span>';
                document.getElementById('startImport').disabled = false;
                await loadExistingData();
            } else {
                document.getElementById('authStatus').innerHTML = '<span style="color:#ff6b6b">‚úó Not signed in. Please sign in to BreadHub ProofMaster first, then refresh this page.</span>';
            }
        });

        async function loadExistingData() {
            log('Loading existing data from Firebase...');
            
            const suppliersSnap = await db.collection('suppliers').get();
            suppliersSnap.forEach(doc => {
                existingSuppliers[doc.data().companyName] = doc.id;
            });
            log('Found ' + Object.keys(existingSuppliers).length + ' existing suppliers', 'info');

            const ingredientsSnap = await db.collection('ingredients').get();
            ingredientsSnap.forEach(doc => {
                existingIngredients[doc.data().name] = doc.id;
            });
            log('Found ' + Object.keys(existingIngredients).length + ' existing ingredients', 'info');
            log('Ready to import!', 'success');
        }

        function log(msg, type = 'info') {
            const logEl = document.getElementById('log');
            const color = type === 'error' ? '#ff6b6b' : type === 'success' ? '#51cf66' : '#74c0fc';
            logEl.innerHTML += '<span style="color:' + color + '">' + msg + '</span>\n';
            logEl.scrollTop = logEl.scrollHeight;
        }

        function updateProgress(current, total) {
            const pct = Math.round((current / total) * 100);
            document.getElementById('progressBar').style.width = pct + '%';
        }

        async function startImport() {
            document.getElementById('startImport').disabled = true;
            document.getElementById('progressContainer').style.display = 'block';
            document.getElementById('log').innerHTML = '';
            
            const total = importData.suppliers.length + importData.ingredients.length;
            let current = 0;
            let suppliersAdded = 0, suppliersSkipped = 0;
            let ingredientsAdded = 0, ingredientsSkipped = 0;
            let pricesAdded = 0, pricesSkipped = 0;

            // Import suppliers
            log('\n=== IMPORTING SUPPLIERS ===', 'info');
            for (const supplier of importData.suppliers) {
                current++;
                updateProgress(current, total);
                
                if (existingSuppliers[supplier.companyName]) {
                    log('‚è≠ Skip existing: ' + supplier.companyName);
                    suppliersSkipped++;
                } else {
                    try {
                        const docRef = await db.collection('suppliers').add({
                            ...supplier,
                            createdAt: new Date().toISOString()
                        });
                        existingSuppliers[supplier.companyName] = docRef.id;
                        log('‚úì Added supplier: ' + supplier.companyName, 'success');
                        suppliersAdded++;
                    } catch (e) {
                        log('‚úó Error adding ' + supplier.companyName + ': ' + e.message, 'error');
                    }
                }
            }

            // Import ingredients
            log('\n=== IMPORTING INGREDIENTS ===', 'info');
            for (const ing of importData.ingredients) {
                current++;
                updateProgress(current, total);
                
                let ingredientId = existingIngredients[ing.name];
                
                if (!ingredientId) {
                    try {
                        const docRef = await db.collection('ingredients').add({
                            name: ing.name,
                            category: ing.category,
                            costingMethod: 'lastPurchase',
                            createdAt: new Date().toISOString()
                        });
                        ingredientId = docRef.id;
                        existingIngredients[ing.name] = ingredientId;
                        log('‚úì Added ingredient: ' + ing.name, 'success');
                        ingredientsAdded++;
                    } catch (e) {
                        log('‚úó Error adding ' + ing.name + ': ' + e.message, 'error');
                        continue;
                    }
                } else {
                    log('‚è≠ Ingredient exists: ' + ing.name + ' (will add prices)');
                    ingredientsSkipped++;
                }

                // Add prices for this ingredient
                for (const price of ing.prices) {
                    const supplierId = existingSuppliers[price.supplierName];
                    if (!supplierId) {
                        log('  ‚ö† No supplier ID for ' + price.supplierName, 'error');
                        continue;
                    }

                    // Check if this exact price entry exists (same ingredient + supplier + packageSize)
                    const existingPrice = await db.collection('ingredientPrices')
                        .where('ingredientId', '==', ingredientId)
                        .where('supplierId', '==', supplierId)
                        .where('packageSize', '==', price.packageSize)
                        .get();

                    if (existingPrice.empty) {
                        try {
                            await db.collection('ingredientPrices').add({
                                ingredientId: ingredientId,
                                ingredientName: ing.name,
                                supplierId: supplierId,
                                supplierName: price.supplierName,
                                purchasePrice: price.purchasePrice,
                                packageSize: price.packageSize,
                                costPerGram: price.costPerGram,
                                lastPurchaseDate: new Date().toISOString(),
                                createdAt: new Date().toISOString()
                            });
                            log('  üí∞ Price: ' + price.supplierName + ' @ ‚Ç±' + price.purchasePrice + '/' + price.packageSize + 'g', 'success');
                            pricesAdded++;
                        } catch (e) {
                            log('  ‚úó Error adding price: ' + e.message, 'error');
                        }
                    } else {
                        log('  ‚è≠ Price exists: ' + price.supplierName + ' ' + price.packageSize + 'g');
                        pricesSkipped++;
                    }
                }
            }

            log('\n=== IMPORT COMPLETE ===', 'success');
            log('Suppliers: ' + suppliersAdded + ' added, ' + suppliersSkipped + ' skipped', 'info');
            log('Ingredients: ' + ingredientsAdded + ' added, ' + ingredientsSkipped + ' skipped', 'info');
            log('Prices: ' + pricesAdded + ' added, ' + pricesSkipped + ' skipped', 'info');
            log('\nüéâ Refresh your BreadHub app to see the changes!', 'success');
            document.getElementById('startImport').disabled = false;
        }
    </script>
</body>
</html>
